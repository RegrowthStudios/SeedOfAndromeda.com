Persist=function(){var e="0.1.0",t,n,s,o,u,a;a=function(){var e="Thu, 01-Jan-1970 00:00:01 GMT",t=1e3*60*60*24,n=["expires","path","domain"],r=escape,s=unescape,o=document,u;var a=function(){var e=new Date;e.setTime(e.getTime());return e};var f=function(e,t){var i,s,o,u=[],a=arguments.length>2?arguments[2]:{};u.push(r(e)+"="+r(t));for(i=0;i<n.length;i++){s=n[i];if(o=a[s])u.push(s+"="+o)}if(a.secure)u.push("secure");return u.join("; ")};var l=function(){var e="__EC_TEST__",t=new Date;t=t.toGMTString();this.set(e,t);this.enabled=this.remove(e)==t;return this.enabled};u={set:function(e,n){var r=arguments.length>2?arguments[2]:{},s=a(),u,l={};if(r.expires){r.expires*=t;l.expires=new Date(s.getTime()+r.expires);l.expires=l.expires.toGMTString()}var c=["path","domain","secure"];for(i=0;i<c.length;i++)if(r[c[i]])l[c[i]]=r[c[i]];var h=f(e,n,l);o.cookie=h;return n},has:function(e){e=r(e);var t=o.cookie,n=t.indexOf(e+"="),i=n+e.length+1,s=t.substring(0,e.length);return!n&&e!=s||n<0?false:true},get:function(e){e=r(e);var t=o.cookie,n=t.indexOf(e+"="),i=n+e.length+1,u=t.substring(0,e.length),a;if(!n&&e!=u||n<0)return null;a=t.indexOf(";",i);if(a<0)a=t.length;return s(t.substring(i,a))},remove:function(t){var n=u.get(t),r={expires:e};o.cookie=f(t,"",r);return n},keys:function(){var e=o.cookie,t=e.split("; "),n,r,i=[];for(n=0;n<t.length;n++){r=t[n].split("=");i.push(s(r[0]))}return i},all:function(){var e=o.cookie,t=e.split("; "),n,r,i=[];for(n=0;n<t.length;n++){r=t[n].split("=");i.push([s(r[0]),s(r[1])])}return i},version:"0.2.1",enabled:false};u.enabled=l.call(u);return u}();u=function(){};s=function(e){return"PS"+e.replace(/_/g,"__").replace(/ /g,"_s")};C={search_order:["gears","localstorage","whatwg_db","globalstorage","flash","ie","cookie"],name_re:/^[a-z][a-z0-9_ -]+$/i,methods:["init","get","set","remove","load","save"],sql:{version:"1",create:"CREATE TABLE IF NOT EXISTS persist_data (k TEXT UNIQUE NOT NULL PRIMARY KEY, v TEXT NOT NULL)",get:"SELECT v FROM persist_data WHERE k = ?",set:"INSERT INTO persist_data(k, v) VALUES (?, ?)",remove:"DELETE FROM persist_data WHERE k = ?"},flash:{div_id:"_persist_flash_wrap",id:"_persist_flash",path:"persist.swf",size:{w:1,h:1},args:{autostart:true}}};n={gears:{size:-1,test:function(){return window.google&&window.google.gears?true:false},methods:{transaction:function(e){var t=this.db;t.execute("BEGIN").close();e.call(this,t);t.execute("COMMIT").close()},init:function(){var e;e=this.db=google.gears.factory.create("beta.database");e.open(s(this.name));e.execute(C.sql.create).close()},get:function(e,t,n){var r,i=C.sql.get;if(!t)return;this.transaction(function(s){r=s.execute(i,[e]);if(r.isValidRow())t.call(n||this,true,r.field(0));else t.call(n||this,false,null);r.close()})},set:function(e,t,n,r){var i=C.sql.remove,s=C.sql.set,o;this.transaction(function(o){o.execute(i,[e]).close();o.execute(s,[e,t]).close();if(n)n.call(r||this,true,t)})},remove:function(e,t,n){var i=C.sql.get;sql=C.sql.remove,r,val;this.transaction(function(s){if(t){r=s.execute(i,[e]);if(r.isValidRow()){val=r.field(0);s.execute(sql,[e]).close();t.call(n||this,true,val)}else{t.call(n||this,false,null)}r.close()}else{s.execute(sql,[e]).close()}})}}},whatwg_db:{size:200*1024,test:function(){var e="PersistJS Test",t="Persistent database test.";if(!window.openDatabase)return false;if(!window.openDatabase(e,C.sql.version,t,n.whatwg_db.size))return false;return true},methods:{transaction:function(e){if(!this.db_created){var t=C.sql.create;this.db.transaction(function(e){e.executeSql(t,[],function(){this.db_created=true})},u)}this.db.transaction(e)},init:function(){var e,t;e=this.o.about||"Persistent storage for "+this.name;t=this.o.size||n.whatwg_db.size;this.db=openDatabase(this.name,C.sql.version,e,t)},get:function(e,t,n){var r=C.sql.get;if(!t)return;n=n||this;this.transaction(function(i){i.executeSql(r,[e],function(e,r){if(r.rows.length>0)t.call(n,true,r.rows.item(0)["v"]);else t.call(n,false,null)})})},set:function(e,t,n,r){var i=C.sql.remove,s=C.sql.set;this.transaction(function(o){o.executeSql(i,[e],function(){o.executeSql(s,[e,t],function(e,i){if(n)n.call(r||this,true,t)})})});return t},remove:function(e,t,n){var r=C.sql.get;sql=C.sql.remove;this.transaction(function(i){if(t){i.executeSql(r,[e],function(r,i){if(i.rows.length>0){var s=i.rows.item(0)["v"];r.executeSql(sql,[e],function(e,r){t.call(n||this,true,s)})}else{t.call(n||this,false,null)}})}else{i.executeSql(sql,[e])}})}}},globalstorage:{size:5*1024*1024,test:function(){return window.globalStorage?true:false},methods:{key:function(e){return s(this.name)+s(e)},init:function(){this.store=globalStorage[this.o.domain]},get:function(e,t,n){e=this.key(e);if(t)t.call(n||this,true,this.store.getItem(e))},set:function(e,t,n,r){e=this.key(e);this.store.setItem(e,t);if(n)n.call(r||this,true,t)},remove:function(e,t,n){var r;e=this.key(e);r=this.store[e];this.store.removeItem(e);if(t)t.call(n||this,r!==null,r)}}},localstorage:{size:-1,test:function(){return window.localStorage?true:false},methods:{key:function(e){return s(this.name)+s(e)},init:function(){this.store=localStorage},get:function(e,t,n){e=this.key(e);if(t)t.call(n||this,true,this.store.getItem(e))},set:function(e,t,n,r){e=this.key(e);this.store.setItem(e,t);if(n)n.call(r||this,true,t)},remove:function(e,t,n){var r;e=this.key(e);r=this.store.getItem(e);this.store.removeItem(e);if(t)t.call(n||this,r!==null,r)}}},ie:{prefix:"_persist_data-",size:64*1024,test:function(){return window.ActiveXObject?true:false},make_userdata:function(e){var t=document.createElement("div");t.id=e;t.style.display="none";t.addBehavior("#default#userData");document.body.appendChild(t);return t},methods:{init:function(){var e=n.ie.prefix+s(this.name);this.el=n.ie.make_userdata(e);if(this.o.defer)this.load()},get:function(e,t,n){var r;e=s(e);if(!this.o.defer)this.load();r=this.el.getAttribute(e);if(t)t.call(n||this,r?true:false,r)},set:function(e,t,n,r){e=s(e);this.el.setAttribute(e,t);if(!this.o.defer)this.save();if(n)n.call(r||this,true,t)},load:function(){this.el.load(s(this.name))},save:function(){this.el.save(s(this.name))}}},cookie:{delim:":",size:4e3,test:function(){return t.Cookie.enabled?true:false},methods:{key:function(e){return this.name+n.cookie.delim+e},get:function(e,t,n,r){e=this.key(e);t=a.get(e);if(n)n.call(r||this,t!=null,t)},set:function(e,t,n,r){e=this.key(e);a.set(e,t,this.o);if(n)n.call(r||this,true,t)},remove:function(e,t,n,r){var t;e=this.key(e);t=a.remove(e);if(n)n.call(r||this,t!=null,t)}}},flash:{test:function(){if(!window.SWFObject||!deconcept||!deconcept.SWFObjectUtil)return false;var e=deconcept.SWFObjectUtil.getPlayerVersion().major;return e>=8?true:false},methods:{init:function(){if(!n.flash.el){var e,t,r,i=C.flash;r=document.createElement("div");r.id=i.div_id;document.body.appendChild(r);e=new SWFObject(this.o.swf_path||i.path,i.id,i.size.w,i.size.h,"8");for(t in i.args)e.addVariable(t,i.args[t]);e.write(r);n.flash.el=document.getElementById(i.id)}this.el=n.flash.el},get:function(e,t,n){var r;e=s(e);r=this.el.get(this.name,e);if(t)t.call(n||this,r!==null,r)},set:function(e,t,n,r){var i;e=s(e);i=this.el.set(this.name,e,t);if(n)n.call(r||this,true,t)},remove:function(e,t,n){var r;e=s(e);r=this.el.remove(this.name,e);if(t)t.call(n||this,true,r)}}}};var o=function(){var e,r,i,s,o=C.methods,a=C.search_order;for(e=0,r=o.length;e<r;e++)t.Store.prototype[o[e]]=u;t.type=null;t.size=-1;for(e=0,r=a.length;!t.type&&e<r;e++){i=n[a[e]];if(i.test()){t.type=a[e];t.size=i.size;for(s in i.methods)t.Store.prototype[s]=i.methods[s]}}t._init=true};t={VERSION:e,type:null,size:0,add:function(e){n[e.id]=e;C.search_order=[e.id].concat(C.search_order);o()},remove:function(e){var t=C.search_order.indexOf(e);if(t<0)return;C.search_order.splice(t,1);delete n[e];o()},Cookie:a,Store:function(e,n){if(!C.name_re.exec(e))throw new Error("Invalid name");if(!t.type)throw new Error("No suitable storage found");n=n||{};this.name=e;n.domain=n.domain||location.hostname||"localhost.localdomain";this.o=n;n.expires=n.expires||365*2;n.path=n.path||"/";this.init()}};o();return t}()